<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
<title>WaterHero v3.5 â€” æ‰‹æ©Ÿå–®é ç‰ˆ</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
* { box-sizing: border-box; }
body { margin:0; padding:0; overflow-x:hidden; font-family:sans-serif; background: #e0f2fe; color:#111827;}
.glass { backdrop-filter: blur(6px); background: rgba(255,255,255,0.65); border-radius:1rem; padding:1rem; margin-bottom:1rem; }
.dark .glass { background: rgba(17,24,39,0.55); }
.water-bucket-wrapper { position:relative; width:60px; height:120px; border-radius:5px 5px 20px 20px; overflow:hidden; margin-bottom:0.5rem;}
.bucket-outline { position:absolute; top:0; left:0; width:100%; height:100%; border:4px solid #a0a0a0; border-top:8px solid #888; border-radius:5px 5px 20px 20px; pointer-events:none;}
.water-level { position:absolute; bottom:0; left:0; width:100%; height:0%; background: linear-gradient(to top,#007bff,#4dc3ff); transition:height 0.8s ease-out; border-radius:0 0 15px 15px;}
.flower-garden { display:flex; flex-wrap:wrap; justify-content:center; align-content:flex-start; width:100%; height:120px; overflow-y:auto; padding:5px; border-radius:10px; margin-bottom:10px; border:1px dashed #c4d7e9; background:#f7fff7;}
.dark .flower-garden { background:#1a202c; border-color:#4a5568;}
.flower-unit { font-size:1.8em; margin:3px; line-height:1;}
.btn-stack { display:flex; flex-direction:column; gap:0.5rem; margin-top:0.5rem;}
button { padding:0.5rem 1rem; border:none; border-radius:0.5rem; font-size:1rem; cursor:pointer;}
input, select { padding:0.5rem; border-radius:0.5rem; border:1px solid #cbd5e1; width:100%; }
.progress-bar { width:100%; height:8px; background:#e2e8f0; border-radius:4px; overflow:hidden; margin-bottom:0.5rem;}
.progress-fill { height:100%; width:0%; background:#3b82f6; transition: width 0.5s;}
</style>
</head>

<body>
<div class="max-w-md mx-auto p-4">

  <header class="mb-4">
    <h1 class="text-2xl font-bold text-center mb-2">WaterHero ğŸ’§</h1>
    <div class="text-center"><button id="notifyBtn" class="bg-sky-500 text-white w-full">æé†’</button></div>
  </header>

  <!-- ä»Šæ—¥ç›®æ¨™èˆ‡è¼¸å…¥ -->
  <section class="glass">
    <div class="flex justify-between mb-2">
      <div>
        <div class="text-sm text-gray-500">ä»Šæ—¥ç›®æ¨™</div>
        <div class="text-xl font-bold"><span id="goalDisplay">2000</span> ml</div>
      </div>
      <div class="text-right">
        <div class="text-sm text-gray-500">å·²å–</div>
        <div class="text-xl font-bold"><span id="todayTotal">0</span> ml</div>
      </div>
    </div>
    <div class="text-center mb-2">
      <div>ä¸‹æ¬¡æé†’å€’æ•¸:</div>
      <div id="timerDisplay" class="font-bold text-blue-500 text-lg">--:--:--</div>
    </div>
    <div class="progress-bar"><div id="progressFill" class="progress-fill"></div></div>

    <input id="addInput" type="number" placeholder="è¼¸å…¥å–æ°´é‡ (ä¾‹å¦‚250)" class="mb-2">
    <select id="unitSelect" class="mb-2">
      <option value="ml">ml</option>
      <option value="cup">æ¯ (250ml)</option>
    </select>
    <div class="btn-stack">
      <button id="addBtn" class="bg-blue-500 text-white">åŠ å…¥</button>
      <button id="undoBtn" class="bg-red-500 text-white">æ’¤éŠ· â†¶</button>
    </div>
  </section>

  <!-- æ¾†èŠ±æŒ‘æˆ° -->
  <section class="glass">
    <h3 class="text-center font-semibold mb-2">ğŸ’§ æ¾†èŠ±æŒ‘æˆ°</h3>
    <div class="flex justify-center items-end mb-2">
      <div class="water-bucket-wrapper">
        <div id="waterLevel" class="water-level"></div>
        <div class="bucket-outline"></div>
      </div>
    </div>
    <div id="flowerGarden" class="flower-garden"></div>
    <button id="waterFlowerBtn" class="bg-green-500 text-white w-full mt-2" disabled>ğŸ’§ æ¾†èŠ± (1000ml)</button>
  </section>

  <!-- æ°´ç“¶èˆ‡é‡è¨­ -->
  <section class="glass">
    <input id="bottleName" placeholder="ç‚ºä½ çš„æ°´ç“¶å‘½å">
    <button id="bottleSaveBtn" class="bg-blue-500 text-white w-full mt-2">ç¢ºå®š</button>
    <div id="bottleNameDisplay" class="text-center mt-2 font-medium"></div>
    <div class="btn-stack mt-2">
      <button id="resetToday" class="bg-yellow-400 text-white">é‡è¨­ä»Šæ—¥</button>
      <button id="resetAll" class="bg-red-500 text-white">é‡è¨­æ‰€æœ‰ (éœ€è¼¸å…¥ yes)</button>
    </div>
  </section>

</div>

<script>
let todayTotal=0, bucketWater=0, lastInput=0, flowerCount=0, bottleName='', reminderTimer=null, reminderSeconds=0, goal=2000;
const addInputEl=document.getElementById('addInput');
const unitSelectEl=document.getElementById('unitSelect');
const addBtnEl=document.getElementById('addBtn');
const undoBtnEl=document.getElementById('undoBtn');
const waterFlowerBtnEl=document.getElementById('waterFlowerBtn');
const waterLevelEl=document.getElementById('waterLevel');
const flowerGardenEl=document.getElementById('flowerGarden');
const todayTotalEl=document.getElementById('todayTotal');
const progressFillEl=document.getElementById('progressFill');
const bottleInputEl=document.getElementById('bottleName');
const bottleSaveBtnEl=document.getElementById('bottleSaveBtn');
const bottleNameDisplayEl=document.getElementById('bottleNameDisplay');
const timerDisplayEl=document.getElementById('timerDisplay');
const notifyBtnEl=document.getElementById('notifyBtn');
const resetTodayEl=document.getElementById('resetToday');
const resetAllEl=document.getElementById('resetAll');

function updateUI(){
  todayTotalEl.textContent=todayTotal;
  waterLevelEl.style.height=Math.min(bucketWater/1000*100,100)+'%';
  progressFillEl.style.width=Math.min(todayTotal/goal*100,100)+'%';
  waterFlowerBtnEl.disabled=bucketWater<1000;
}

// åŠ æ°´
addBtnEl.onclick=()=>{
  let val=Number(addInputEl.value)||0;
  if(unitSelectEl.value==='cup') val*=250;
  if(val<=0) return;
  todayTotal+=val;
  lastInput=val;
  bucketWater+=val;
  updateUI();
  addInputEl.value='';
};

// æ’¤éŠ·
undoBtnEl.onclick=()=>{
  todayTotal-=lastInput;
  bucketWater-=lastInput;
  lastInput=0;
  updateUI();
};

// æ¾†èŠ±
waterFlowerBtnEl.onclick=()=>{
  if(bucketWater>=1000){
    bucketWater-=1000;
    flowerCount++;
    let flower=document.createElement('div'); flower.className='flower-unit'; flower.textContent='ğŸŒ¸';
    flowerGardenEl.appendChild(flower);
    updateUI();
  }
};

// æ°´ç“¶å‘½å
bottleSaveBtnEl.onclick=()=>{
  bottleName=bottleInputEl.value;
  bottleNameDisplayEl.textContent='æ°´ç“¶åç¨±: '+bottleName;
};

// é‡è¨­ä»Šæ—¥
resetTodayEl.onclick=()=>{
  todayTotal=0; bucketWater=0; lastInput=0; flowerCount=0; flowerGardenEl.innerHTML='';
  updateUI();
};

// é‡è¨­æ‰€æœ‰
resetAllEl.onclick=()=>{
  let confirmAll=prompt('è¼¸å…¥ yes ç¢ºèªé‡è¨­æ‰€æœ‰è³‡æ–™');
  if(confirmAll==='yes') resetTodayEl.onclick();
};

// æé†’å€’æ•¸ï¼ˆç°¡æ˜“ï¼‰
notifyBtnEl.onclick=()=>{
  let mins=prompt('è¨­å®šæé†’æ™‚é–“(åˆ†é˜)');
  if(!mins) return;
  reminderSeconds=Number(mins)*60;
  if(reminderTimer) clearInterval(reminderTimer);
  reminderTimer=setInterval(()=>{
    if(reminderSeconds<=0){ clearInterval(reminderTimer); alert('æ™‚é–“åˆ°ï¼å–æ°´å›‰ ğŸ’§'); timerDisplayEl.textContent='--:--:--'; return;}
    reminderSeconds--;
    let h=Math.floor(reminderSeconds/3600);
    let m=Math.floor((reminderSeconds%3600)/60);
    let s=reminderSeconds%60;
    timerDisplayEl.textContent=(h>9?h:'0'+h)+':' + (m>9?m:'0'+m)+':' + (s>9?s:'0'+s);
  },1000);
};

updateUI();
</script>
</body>
</html>
